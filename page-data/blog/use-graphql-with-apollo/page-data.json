{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/use-graphql-with-apollo","result":{"data":{"markdownRemark":{"html":"<h1>Apollo GraphQL + Koaå®ä¾‹æ•™ç¨‹</h1>\n<blockquote>\n<p><a href=\"http://graphql.cn/learn/\">GraphQL å…¥é—¨ | GraphQL</a> GraphQLä¸­æ–‡æ–‡æ¡£</p>\n<p><a href=\"https://www.apollographql.com/\">Apollo GraphQL</a>, å®ç°GraphQLçš„å¼•æ“ï¼Œå¤§éƒ¨åˆ†ä½¿ç”¨æ–¹æ³•èƒ½ä»ä¸­æŸ¥è¯¢</p>\n<p><a href=\"https://akryum.github.io/vue-apollo/zh-cn/\">Vue Apollo</a> å®¢æˆ·ç«¯ä¸­Vue GraphQLåº“ï¼Œæœ‰ä¸€ç³»åˆ—å°è£…å¥½çš„æ–¹æ³•ã€‚</p>\n</blockquote>\n<p>ä¸¤ä¸ªä¸ªé‡è¦æ¦‚å¿µ</p>\n<ul>\n<li><strong>Schema</strong>  å³ä¸ºGraphQLä¸­çš„<code class=\"language-text\">types</code>(ç±»å‹)ï¼Œä¸ºæœåŠ¡ä¸­çš„æ ¸å¿ƒï¼Œæè¿°äº†æœåŠ¡ç«¯ä¸­æä¾›ç»™å®¢æˆ·ç«¯å¯ç”¨çš„åŠŸèƒ½ï¼Œæˆ–è€…è¯´å¯æŸ¥è¯¢çš„æ•°æ®ã€‚</li>\n<li><strong>Resolver</strong> åœ¨é¡¹ç›®è®¾è®¡ä¸­æ˜¯ä¸€ä¸ª<code class=\"language-text\">map</code>å¯¹è±¡ï¼Œå¯¹è±¡ä¸­çš„<code class=\"language-text\">key</code>å’Œ<strong>schema</strong>ä¸­<code class=\"language-text\">types</code>çš„å­—æ®µæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œæè¿°äº†<code class=\"language-text\">types</code>ä¸­æ•°æ®çš„æ¥æºã€‚</li>\n</ul>\n<p>ä¸¤ä¸ªç‰¹æ®Šç±»å‹\næ¯ä¸€ä¸ª GraphQL æœåŠ¡éƒ½æœ‰ä¸€ä¸ªqueryç±»å‹ï¼Œå¯èƒ½æœ‰ä¸€ä¸ªmutationç±»å‹ã€‚</p>\n<ul>\n<li><strong>Query</strong>é‡Œé¢å®šä¹‰äº†æœåŠ¡å™¨æä¾›ç»™å‰ç«¯çš„ä¸€äº›å¯æŸ¥è¯¢çš„ç±»å‹ï¼Œç›¸å½“äºä»¥å‰çš„ä¸€ä¸ªRestfulæ¥å£ï¼Œåªæœ‰<em>Query</em>é‡Œçš„å­—æ®µæ‰èƒ½æŸ¥è¯¢ã€‚</li>\n<li><strong>Mutation</strong>äº¦å·®ä¸å¤šï¼Œåªæ˜¯<strong>Mutation</strong>è¡¨ç¤ºçš„æ˜¯å˜æ›´æ“ä½œï¼Œå¦‚å¢åˆ æ”¹è¿™äº›æ¥å£æ“ä½œã€‚</li>\n</ul>\n<!-- more -->\n<h1>GraphQLå®ä¾‹</h1>\n<p>è¿è¡Œä¸‹é¢çš„ç±»å®šä¹‰å‰æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœ€ç®€å•çš„æœåŠ¡ï¼Œé¦–å…ˆæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åå®‰è£…æ‰€éœ€ä¾èµ–\n<code class=\"language-text\">npm i apollo-server-koa graphql koa nodemon</code></p>\n<p>ç„¶ååœ¨ç›®å½•ä¸‹å¿ƒæ–°å»ºä¸€ä¸ª<code class=\"language-text\">app.js</code>çš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Koa <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> ApolloServer<span class=\"token punctuation\">,</span> gql <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'apollo-server-koa'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// å®šä¹‰ä¸€ä¸ªç®€å•çš„ç±»å‹</span>\n<span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type Query {\n    hello: String\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// å®šä¹‰resolvers</span>\n<span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  Query<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">hello</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">'Hello world!'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ApolloServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> typeDefs<span class=\"token punctuation\">,</span> resolvers <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Koa</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> app <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> <span class=\"token string\">'8888'</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> port <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">ğŸš€ Server ready at http://localhost:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>server<span class=\"token punctuation\">.</span>graphqlPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç„¶åæ‰“å¼€åœ°å€è¾“å…¥åœ°å€åæŸ¥è¯¢<code class=\"language-text\">hello</code>å³å¯çœ‹åˆ°åé¦ˆç»“æœ<code class=\"language-text\">hello world!</code></p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token comment\"># Write your query or mutation here</span>\n<span class=\"token punctuation\">{</span>\n\thello\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åˆ°è¿™é‡Œæˆ‘ä»¬å³å¯åŠ¨å¥½ä¸€ä¸ªç®€å•çš„æœåŠ¡ã€‚</p>\n<h2>ç±»å‹å®šä¹‰</h2>\n<p>ä¸‹é¢ä¼šè®¾è®¡ä¸€ä¸ªç®€å•çš„å›¾ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œç”±äºæ²¡æœ‰æœåŠ¡æ¥å£ï¼Œæˆ‘ä»¬å…ˆæ‹Ÿå®šä¸€ä»½æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºåç«¯è¿”å›çš„æ•°æ®ï¼Œä¿®æ”¹<code class=\"language-text\">app.js</code>ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// ä»è¿™é‡Œå¼€å§‹</span>\n<span class=\"token keyword\">const</span> authors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"Jerry\"</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"Tom\"</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> books <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"ç™½å¤œè¡Œ\"</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n    authorId<span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"å‚²æ…¢ä¸åè§\"</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span>\n    authorId<span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"æ—¶ç”Ÿ\"</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span>\n    authorId<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"Javascripté«˜çº§ç¨‹åºè®¾è®¡\"</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token operator\">:</span> <span class=\"token string\">\"4\"</span><span class=\"token punctuation\">,</span>\n    authorId<span class=\"token operator\">:</span> <span class=\"token string\">\"2\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æˆ‘ä»¬å…ˆæ·»åŠ ä¸€ä¸ªç®€å•çš„ç”¨æˆ·å’Œä¹¦æœ¬æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½è¿”å›ä¸€ä¸ªç”¨æˆ·å’Œä¹¦æœ¬åˆ—è¡¨ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦æ·»åŠ <code class=\"language-text\">Author</code>å’Œ<code class=\"language-text\">Book</code>ç±»å‹å’Œåœ¨Queryé‡Œé¢æ·»åŠ å¯¹åº”æŸ¥è¯¢å­—æ®µï¼Œä¿®æ”¹<strong>typeDefs</strong>å¯¹è±¡ä¸ºä»¥ä¸‹ä»£ç </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  type Query {\n    authors: [Author]!\n    books: [Book]!\n  }\n\n  type Author {\n    name: String!\n    id: ID!\n  }\n\n  type Book {\n    name: String!\n    id: ID!\n    authorId: ID!\n  }\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å®šä¹‰å¥½ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸ºç±»å‹æ·»åŠ æ•°æ®æ¥æºçš„æè¿°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹ä¹‹å‰å®šä¹‰å¥½çš„<code class=\"language-text\">resolvers</code>å¯¹è±¡</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  Query<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">authors</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> authors<span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">books</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> books\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æŸ¥è¯¢ç®€å•åˆ—è¡¨åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹ç‰¹å®š<strong>id</strong>çš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æŸä¸ªauthoræˆ–bookï¼Œå› ä¸ºå·²ç»æœ‰äº†å¯¹åº”çš„<code class=\"language-text\">schema</code>ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨<code class=\"language-text\">query</code>ä¸­æ·»åŠ å¯¹åº”æ¥å£å³å¯</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql`\n  type Query <span class=\"token punctuation\">{</span>\n    authors<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Author<span class=\"token punctuation\">]</span><span class=\"token operator\">!</span>\n    books<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>Book<span class=\"token punctuation\">]</span><span class=\"token operator\">!</span>\n    <span class=\"token comment\">// æ­¤å¤„ä¸ºæ–°å¢</span>\n    <span class=\"token function\">author</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token constant\">ID</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Author\n    <span class=\"token function\">book</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token constant\">ID</span><span class=\"token operator\">!</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Book\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç„¶ååœ¨<code class=\"language-text\">resolvers</code>å¯¹è±¡ä¸­æ·»åŠ å¯¹åº”å†…å®¹</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> resolvers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  Query<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">authors</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> authors<span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">books</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> books<span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">author</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> authors<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">book</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> books<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åˆ°æ­¤æˆ‘ä»¬å·²ç»å®ç°äº†æ‰€æœ‰åŸºæœ¬çš„æŸ¥è¯¢äº†ï¼Œä½†é™¤æ­¤ä¹‹å¤–ï¼Œ<code class=\"language-text\">author</code>å’Œ<code class=\"language-text\">book</code>åº”è¯¥è¿˜æœ‰ç€å¯¹åº”çš„å…³ç³»ï¼Œæ¯”å¦‚æŸæœ¬ä¹¦å±äºå“ªä¸ªä½œè€…ï¼Œæˆ–è€…è¯´æŸä¸ªä½œè€…å†™äº†å“ªæœ¬ä¹¦è¿™æ ·ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦æ€ä¹ˆå¤„ç†å‘¢</p>\n<p>å¾ˆç®€å•ï¼Œæˆ‘ä»¬è¿˜æ˜¯å’Œä¸Šæ–¹ä¸€æ ·ï¼Œæ·»åŠ å­—æ®µï¼Œæè¿°å­—æ®µæ•°æ®å¦‚ä½•è¿”å›å³å¯ï¼Œä¸‹é¢æˆ‘ä»¬ä¿®æ”¹<code class=\"language-text\">Author</code>å’Œ<code class=\"language-text\">Book</code>çš„<em>schema</em>\nâš ï¸<em>æ³¨æ„ä¸è¦åˆ é™¤æ—§ä»£ç </em></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> typeDefs <span class=\"token operator\">=</span> gql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  \"\"\"Some Query\"\"\"\n\n\ttype Book {\n\t\tname: String!\n\t\tid: String!\n\t\tauthorId: String!\n\t\tauthor: Author\n\t}\n\n\ttype Author {\n\t\tname: String!\n\t\tid: String!\n      books: [Book]\n\t}\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>ä»ä¸Šæ–¹ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code class=\"language-text\">Book</code>å’Œ<code class=\"language-text\">Author</code>éƒ½æ–°å¢äº†ä¸€ä¸ªå­—æ®µï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µæœ‰ä¸ªç‰¹åˆ«çš„åœ°æ–¹å°±æ˜¯éœ€è¦å…ˆçŸ¥é“çˆ¶çº§IDæ‰èƒ½æ‰¾åˆ°ä¸‹ä¸€é›†çš„æ•°æ®ï¼Œå¦‚è¦å…ˆçŸ¥é“ç”¨æˆ·IDæ‰èƒ½åœ¨Book Listé‡Œé¢ç­›é€‰å‡ºå¯¹åº”çš„æ•°æ®ã€‚æ‰€ä»¥åœ¨è¿™é‡Œè®¾ç½®å¯¹åº”çš„<code class=\"language-text\">resolvers</code>ï¼Œè¿™é‡Œæœ‰ç‚¹ç‰¹åˆ«ï¼Œæˆ‘ä»¬å…ˆä¸Šä»£ç ï¼Œç»§ç»­ä¿®æ”¹<code class=\"language-text\">resolvers</code>å¯¹è±¡</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> resolverMap <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\tQuery<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// è¿™é‡Œçš„å†…å®¹çœç•¥</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// è¿™é‡Œå¼€å§‹æ˜¯æ–°åŠ çš„å†…å®¹</span>\n  Author<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">books</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> books<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>authorId <span class=\"token operator\">===</span> parent<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  Book<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">author</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> authors<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> parent<span class=\"token punctuation\">.</span>authorId<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>éšååœ¨<a href=\"http://localhost:8888/graphql\">playground</a>é¡µé¢è¾“å…¥ä»¥ä¸‹ä»£ç è¿›è¡ŒæŸ¥è¯¢</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n\tauthor<span class=\"token punctuation\">(</span><span class=\"token attr-name\">id</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    name\n    books <span class=\"token punctuation\">{</span>\n      name\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  book<span class=\"token punctuation\">(</span><span class=\"token attr-name\">id</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    name\n    author <span class=\"token punctuation\">{</span>\n      name\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åœ¨è¿™é‡Œï¼Œå·²ç»å®Œæˆä¸šåŠ¡åŸºæœ¬æ¶µç›–çš„åŠŸèƒ½äº†ï¼Œæ€ä¹ˆå®šä¹‰æ•°æ®å’ŒæŸ¥è¯¢ï¼Œä»ä¸Šæ–¹æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å‘ç°GraphQLä¸­çš„ä¸€ä¸ªç¼ºç‚¹ï¼Œä½†åˆèƒ½è¯´æ˜¯è¯´ä¼˜ç‚¹ï¼Œå°±æ˜¯å¯ä»¥<em>æ— é™å¾ªç¯æŸ¥è¯¢</em>ï¼Œå¦‚ä¿®æ”¹ä¸Šæ–¹çš„æŸ¥è¯¢</p>\n<div class=\"gatsby-highlight\" data-language=\"grapnel\"><pre class=\"language-grapnel\"><code class=\"language-grapnel\">{\n  book(id: 1) {\n    name\n    author {\n      name\n      books {\n        name\n      }\n    }\n  }\n}</code></pre></div>\n<h2>ç»“è¯­</h2>\n<p>åœ¨ä¸Šé¢çš„ä¸€ä¸ªç®€å•ä¾‹å­å¯ä»¥å¤§æ¦‚æ¸…æ¥šGraphQLé‡Œé¢ä¸€ä¸ªå·¥ä½œæµç¨‹ï¼Œè¿˜æœ‰<em>Mutation</em>ç­‰ä¸€äº›ç‰¹å®šç±»å‹æ²¡æœ‰ä»‹ç»ï¼Œä¸è¿‡ä¹Ÿå’Œ<em>Query</em>å·®ä¸å¤šï¼Œæ¯•ç«Ÿä¹Ÿæ˜¯ä¸€ä¸ªæŸ¥è¯¢è€Œå·²ï¼Œåªæ˜¯å¤„ç†çš„äº‹æƒ…ä¸ä¸€æ ·ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯èƒ½åœ¨ä¸šåŠ¡ä¸Šé¢æ›´å¤šçš„å®ç°éš¾åº¦æ˜¯åœ¨ç”¨æˆ·éªŒè¯ï¼Œåœ¨åº”ç”¨ä¸­ä¼ é€’ä¸Šä¸‹æ–‡Contextç­‰ã€‚</p>\n<p>åœ¨ä¸€äº›ç‰¹å®šçš„ä¸šåŠ¡åœºæ™¯ï¼Œ<em>GraphQL</em>è¿˜èƒ½å±•ç¤ºå‡ºæ›´å¤šçš„éªšæ“ä½œï¼Œå¤§å®¶æœ‰å…´è¶£çš„è¯å¯ä»¥ç»§ç»­æ‰¾æˆ‘è¿™è¾¹äº¤æµï¼ŒThanksğŸŒ</p>","frontmatter":{"date":"March 15, 2019","path":"/blog/use-graphql-with-apollo","title":"Apollo GraphQL + Koaå®ä¾‹æ•™ç¨‹","category":["æœåŠ¡ç«¯"]},"headings":[{"depth":1,"value":"Apollo GraphQL + Koaå®ä¾‹æ•™ç¨‹"},{"depth":1,"value":"GraphQLå®ä¾‹"},{"depth":2,"value":"ç±»å‹å®šä¹‰"},{"depth":2,"value":"ç»“è¯­"}],"tableOfContents":"<ul>\n<li><a href=\"/blog/use-graphql-with-apollo/#apollo-graphql--koa%E5%AE%9E%E4%BE%8B%E6%95%99%E7%A8%8B\">Apollo GraphQL + Koaå®ä¾‹æ•™ç¨‹</a></li>\n<li>\n<p><a href=\"/blog/use-graphql-with-apollo/#graphql%E5%AE%9E%E4%BE%8B\">GraphQLå®ä¾‹</a></p>\n<ul>\n<li><a href=\"/blog/use-graphql-with-apollo/#%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89\">ç±»å‹å®šä¹‰</a></li>\n<li><a href=\"/blog/use-graphql-with-apollo/#%E7%BB%93%E8%AF%AD\">ç»“è¯­</a></li>\n</ul>\n</li>\n</ul>"}},"pageContext":{"slug":"/blog/use-graphql-with-apollo","next":{"frontmatter":{"title":"ä½¿ç”¨pre-commitå®ç°æäº¤å‰éªŒè¯æˆ–è‡ªåŠ¨éƒ¨ç½²ä»£ç ","date":"2018-03-29","category":["å‰ç«¯"],"tags":["è‡ªåŠ¨åŒ–","å‰ç«¯å·¥å…·"],"path":"/post/pre-commit-hook"}},"previous":{"frontmatter":{"title":"What's AST & How AST","date":"2019-05-25","category":["javascript"],"tags":["babel","AST"],"path":"/post/what-and-how-ast"}}}}}