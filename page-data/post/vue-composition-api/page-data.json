{"componentChunkName":"component---src-templates-post-tsx","path":"/post/vue-composition-api","result":{"data":{"markdownRemark":{"html":"<p>æœ¬æ–‡æ˜¯Vueä¸­3æ–°çš„Composition APIç®€å•ä»‹ç»åŠä½¿ç”¨æŒ‡å—ï¼Œå…·ä½“å†…å®¹å¯ä»¥è‡ªè¡Œé˜…è¯»å®˜æ–¹æä¾›çš„<a href=\"https://vue-composition-api-rfc.netlify.com/#summary\">RFC</a>ã€‚</p>\n<p>é™„ä¸Šåˆ†äº«PPT</p>\n<blockquote>\n<p>vue-composition-api slides â€” <a href=\"https://slides.com/kitwang/vue-composition-api/fullscreen\">https://slides.com/kitwang/vue-composition-api/fullscreen</a></p>\n</blockquote>\n<h2>Motivation</h2>\n<p>æ‰€æœ‰APIéƒ½ä¸æ˜¯å¶ç„¶è®¾è®¡å‡ºæ¥çš„ï¼Œæ‰€ä»¥ä½œè€…çš„è®¾è®¡çš„æ—¶å€™å¿…å®šæœ‰ä»–çš„å«ä¹‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹æ–‡æ¡£ä¸­æåˆ°çš„ä¸¤ä¸ªè®¾è®¡åŠ¨æœºã€‚</p>\n<ul>\n<li>é€»è¾‘å¤ç”¨åŠä»£ç æ•´ç†</li>\n<li>æ›´å¥½çš„Typescriptæ”¯æŒ</li>\n</ul>\n<p>åƒVueè¿™ç§ç°ä»£æ¡†æ¶å·²ç»å¾ˆå¥½è§£å†³äº†ç»„ä»¶å¤ç”¨è¿™ä¸€é—®é¢˜äº†ï¼Œä½†æ˜¯éšç€æ—¶é—´æ¨ç§»ï¼Œä½ ä¼šå‘ç°ç»„ä»¶é‡Œé¢çš„çŠ¶æ€å’Œé€»è¾‘ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œè¶Šæ¥è¶Šéš¾ç»´æŠ¤ï¼Œä»¥ä¸€ä¸ªæ™®é€šçš„æœç´¢ç»„ä»¶ä¸ºä¾‹ï¼Œä½¿ç”¨æ™®é€šçš„è¯­æ³•å°±åƒä¸‹é¢çš„ä»£ç é‚£æ ·ï¼Œç”¨<code class=\"language-text\">data</code>å®šä¹‰ç»„ä»¶çš„stateï¼Œåœ¨<code class=\"language-text\">methods</code>é‡Œé¢å®šä¹‰ç»„ä»¶çš„æ–¹æ³•ï¼Œçœ‹èµ·æ¥å°±åƒä¸‹é¢</p>\n<!-- more -->\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token string\">'SearchComponent'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      ğŸ”\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    ğŸ”\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦ä¸€ä¸ªè¿‡æ»¤æœç´¢æ¡ä»¶çš„æ–¹æ³•</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token string\">'SearchComponent'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      ğŸ”\n      ğŸ“‘\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    ğŸ”\n    ğŸ“‘\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œå¤„ç†åŒæ ·é€»è¾‘çš„æ–¹æ³•è¢«åˆ’åˆ†åœ¨<code class=\"language-text\">data</code>å’Œ<code class=\"language-text\">methods</code>é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å›æƒ³ä¸€ä¸‹é™¤æ­¤ä¹‹å¤–å®šä¹‰ä¸€ä¸ªç»„ä»¶æœ‰å¤šå°‘ä¸ªç»„ä»¶é€‰é¡¹ã€‚</p>\n<ul>\n<li>components</li>\n<li>props</li>\n<li>data</li>\n<li>computed</li>\n<li>methods</li>\n<li>lifecycle methods</li>\n</ul>\n<p>å¤„ç†ä¸€ä¸ªé€»è¾‘ï¼ŒçŠ¶æ€åŠæ–¹æ³•å°±å¯èƒ½åˆ†ç¦»åœ¨è¿™6ä¸ªåœ°æ–¹ï¼Œç»´æŠ¤æ—¶é—´ä¸€é•¿äº†ï¼Œå¾ˆæœ‰å¯èƒ½çœ‹åˆ°è¿™ç§åƒè¡Œä»£ç çš„ç»„ä»¶äº†ã€‚ï¼ˆPut some demoï¼‰</p>\n<p>ä½¿ç”¨ <strong>Composition API</strong> çš„è¯ä¼šå˜æˆä»€ä¹ˆæ ·å­å‘¢ï¼Œè¿˜æ˜¯ä»¥ä¸Šæ–¹æœç´¢ç»„ä»¶ä¸¾ä¾‹</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">ğŸ”</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// Search state &amp; methods }</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">ğŸ“‘</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// Sort state &amp; methods }</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token string\">'SearchComponent'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ğŸ”\n    ğŸ“‘\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç»„ä»¶çŠ¶æ€åŠæ–¹æ³•å•ç‹¬åˆ†ç¦»å‡ºæ¥äº†ï¼ä¸‹é¢æˆ‘ä»¬æ¥ç€çœ‹ä¸€ä¸‹å¦‚ä½•ç”¨<code class=\"language-text\">setup</code>ä»£æ›¿ä»¥å‰çš„æ–¹æ³•ã€‚</p>\n<h2>How</h2>\n<p>æˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸Šé¢æœç´¢ç»„ä»¶ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆè½¬åŒ–æˆè¾ƒä¸ºçœŸå®çš„ä»£ç </p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>search<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">v-model</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>searchValue<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>search<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>result<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>result__item<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>item in filterData<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>item.id<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        {{ item.name }}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">v-if</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>loading<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>loading<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    searchValue<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n    loading<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    searchResult<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  computed<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">filterData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> searchResult<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id <span class=\"token operator\">></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/search'</span><span class=\"token punctuation\">,</span> body<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>searchValue<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>searchResult <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">mounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Get initial data</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>é€»è¾‘ä¸å¤æ‚ï¼Œåªæœ‰ä¸€ä¸ªç®€å•çš„æœç´¢æ–¹æ³•å’Œä¸€ä¸ªè¿‡æ»¤æ•°æ®çš„computedæ–¹æ³•ï¼Œç»„ä»¶æŒ‚è½½çš„æ—¶å€™æ‰§è¡Œä¸‹æœç´¢æ–¹æ³•åˆå§‹åŒ–åˆ—è¡¨æ•°æ®ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™éƒ¨åˆ†ä»£ç åœ¨ <strong>Composition API</strong>ä¸‹æ˜¯æ€ä¹ˆå·¥ä½œçš„ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>search<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">v-model</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>state.searchValue<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>search<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>result<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>result__item<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>item in filterData<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>item.id<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        {{ item.name }}\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">v-if</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>state.loading<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>loading<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> reactive<span class=\"token punctuation\">,</span> computed<span class=\"token punctuation\">,</span> onMounted<span class=\"token punctuation\">,</span> toRef <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Initial State</span>\n    <span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token function\">reactive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      searchValue<span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n      loading<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      searchResult<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Computed</span>\n    <span class=\"token keyword\">const</span> filterData <span class=\"token operator\">=</span> <span class=\"token function\">computed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>searchResult<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id <span class=\"token operator\">></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Methods</span>\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/search'</span><span class=\"token punctuation\">,</span> body<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>searchValue<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      state<span class=\"token punctuation\">.</span>searchResult <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      state<span class=\"token punctuation\">.</span>loading <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Lifecircle hook</span>\n    <span class=\"token function\">onMounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token function\">toRef</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> filterData<span class=\"token punctuation\">,</span> search <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ˜æ˜¾çš„å˜åŒ–ï¼š</p>\n<ol>\n<li>ç»„ä»¶ä»åŸæœ¬çš„<strong>é€‰é¡¹é…ç½®</strong>å˜æˆäº†<strong>å‡½æ•°å®šä¹‰</strong></li>\n<li>ç”±äº1ä¸­çš„æ”¹å˜ï¼Œç»„ä»¶ä¹Ÿä¸éœ€è¦ä½¿ç”¨<code class=\"language-text\">this</code>å»æŒ‡å®šå½“å‰ç»„ä»¶æ‰§è¡Œçš„ä¸Šä¸‹æ–‡</li>\n</ol>\n<p>è¿™æ˜¯ç»„ä»¶é€»è¾‘å¤ç”¨é‡è¦çš„ä¸€æ­¥ã€‚</p>\n<h2>é€»è¾‘åˆ†ç¦»å’Œå¤ç”¨</h2>\n<p>ä¸Šæ–¹ç®€å•ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨æ–°çš„APIå»é‡æ„æˆ‘ä»¬çš„ç»„ä»¶ï¼Œä½†æ˜¯è¿˜æ²¡çœŸæ­£çš„æ„Ÿå—åˆ°å®ƒçš„é­…åŠ›ï¼Œæˆ‘ä»¬ç»§ç»­æ‹¿ä¸Šæ–¹é‡å†™å¥½çš„ç»„ä»¶ç»§ç»­æ”¹é€ ï¼ŒæŠŠé€»è¾‘æŠ½ç¦»å‡ºæ¥è¿›è¡Œå¤ç”¨ã€‚æˆ‘ä»¬ä¸€å¼€å§‹å°±çŸ¥é“ç»„ä»¶ä¸­æœ‰<strong>æœç´¢</strong>å’Œ<strong>è¿‡æ»¤æœç´¢æ¡ä»¶</strong>ä¸¤éƒ¨åˆ†é‡è¦åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›®æ ‡å°±æ˜¯æŠŠè¿™ä¸¤éƒ¨åˆ†é€»è¾‘æŠ½ç¦»å‡ºæ¥ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Search logic</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">useSearch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> searchValue <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> searchResult <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> loading <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    loading<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/search'</span><span class=\"token punctuation\">,</span> body<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>searchValue<span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    searchResult<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    loading<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">onMounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> searchValue<span class=\"token punctuation\">,</span> searchResult<span class=\"token punctuation\">,</span> loading<span class=\"token punctuation\">,</span> search <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Filter logic</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">useFilterSearchResult</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">searchResult</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> filterData <span class=\"token operator\">=</span> <span class=\"token function\">computed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> searchResult<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id <span class=\"token operator\">></span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> filterData <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Component Instance</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> search <span class=\"token operator\">=</span> <span class=\"token function\">useSearch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>search<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token function\">useFilterSearchResult</span><span class=\"token punctuation\">(</span>search<span class=\"token punctuation\">.</span>searchResult<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä»è¿™é‡Œæˆ‘ä»¬å·²ç»å®Œå…¨å°†ç»„ä»¶ä¸­çš„çŠ¶æ€éƒ½ç‹¬ç«‹å‡ºæ¥äº†ï¼Œåˆ°æ­¤å·²ç»å¤§æ¦‚å°†<strong>Composition API</strong>è¿è¡Œæ–¹å¼åŠä½¿ç”¨æ–¹å¼å¤§æ¦‚ä»‹ç»å®Œæ¯•äº†ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•æŠŠç»„ä»¶çš„çŠ¶æ€å•ç‹¬åˆ†å¼€ç»´æŠ¤ï¼Œä»¥åŠä½¿ç”¨è¿™äº›å¦‚ä½•ä½¿ç”¨è¿™äº›APIå»ç»„åˆæ‰€æœ‰çŠ¶æ€åŠæ–¹æ³•ã€‚</p>\n<h2>ç¼ºç‚¹</h2>\n<p>èŠå®Œ <strong>Composition API</strong> çš„ä¼˜ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥èŠä¸‹å®ƒçš„ç¼ºç‚¹ã€‚Vueä¸­çš„æ˜¯ä½¿ç”¨<strong>ä¾èµ–è¿½è¸ª</strong>çš„æ–¹å¼å»é€šçŸ¥å˜æ›´çš„ï¼Œæ‰€ä»¥åœ¨å¼€å‘Vueç»„ä»¶çš„æ—¶å€™æˆ‘ä»¬åªéœ€è¦ç”¨<code class=\"language-text\">this.x = y</code>é‡æ–°èµ‹å€¼æŸä¸ªçŠ¶æ€ï¼ŒDOM Treeå°±ä¼šè‡ªåŠ¨å“åº”å˜æ›´ã€‚è¿™æ˜¯Vueçš„ä¼˜åŠ¿ï¼Œä½†åœ¨<code class=\"language-text\">Composition API</code>ä¸­å°±å˜äº†ä¸€ä¸ª<strong>éœ€è¦é‡ç‚¹å…³æ³¨çš„ç‚¹</strong>ï¼Œå¦‚æœä½¿ç”¨ä¸å¥½ï¼Œç”šè‡³ä¼šå˜æˆç¼ºç‚¹ã€‚</p>\n<p>æˆ‘æ˜¯å¯ä»¥ä»è¯•ç€ä»Vueçš„å®ç°åŸç†å»æŸ¥æ‰¾æ­¤åŸå› ã€‚Vue2ä¸­æ˜¯ä½¿ç”¨<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\"><code class=\"language-text\">Object.defineProperty</code></a>ï¼Œè€ŒVue3åˆ™ä½¿ç”¨äº†<a href=\"http://es6.ruanyifeng.com/#docs/proxy\"><code class=\"language-text\">Proxy</code></a>ï¼Œä½†æ— è®ºä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨è®¿é—®å’Œè®¾ç½®æŸä¸ª<code class=\"language-text\">state</code>çš„æ—¶å€™å®é™…æ˜¯è°ƒç”¨äº†ä»–ä»¬<strong>getter/setter</strong>çš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™ä¸ªstateä½œä¸ºä¸€ä¸ª<strong>è¿”å›å€¼</strong>æˆ–è€…<strong>å‚æ•°</strong>çš„æ—¶å€™ï¼Œå®ƒå®é™…æ˜¯ä½œä¸ºä¸€ä¸ª<strong>å€¼</strong>ä¼ é€’åˆ°äº†å¦å¤–è¦ç»™æ–¹æ³•ä¸­ï¼Œæ‰€ä»¥ä»–çš„<strong>getter/setter</strong>å°†ä¼šä¸¢å¤±ï¼Œæ•°æ®æ— æ³•å“åº”ã€‚è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä¾‹å­</p>\n<p>æˆ‘ä»¬å…ˆå»ºç«‹ä¸€ä¸ªè·å–é¼ æ ‡åæ ‡çš„hook</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useMousePostion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> pos <span class=\"token operator\">=</span> <span class=\"token function\">reactive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    y<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token function\">onMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Add Event Listener</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> pos\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// comsuming component</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMousePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// å“åº”ä¸¢å¤±</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// å“åº”ä¸¢å¤±</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token function\">useMousePositon</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// It's work</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      pos<span class=\"token operator\">:</span> <span class=\"token function\">useMousePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ¶‰åŠåˆ°Javascripté‡Œé¢çš„ä¸€äº›åŸºç¡€çŸ¥è¯† <strong>å¼•ç”¨ä¼ é€’åŠå€¼ä¼ é€’</strong></p>\n<h3>å¼•ç”¨ä¼ é€’åŠå€¼ä¼ é€’</h3>\n<p>æ€è€ƒä¸‹é¢çš„ä»£ç </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">changeStuff</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  a <span class=\"token operator\">=</span> a <span class=\"token operator\">*</span> <span class=\"token number\">10</span>\n  b<span class=\"token punctuation\">.</span>item <span class=\"token operator\">=</span> <span class=\"token string\">'changed'</span>\n  c <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> item<span class=\"token operator\">:</span> <span class=\"token string\">'changed'</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> num <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n<span class=\"token keyword\">var</span> obj1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> item<span class=\"token operator\">:</span> <span class=\"token string\">'unchanged'</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> obj2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> item<span class=\"token operator\">:</span> <span class=\"token string\">'unchanged'</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">changeStuff</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span> obje1<span class=\"token punctuation\">,</span> obj2<span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>obj1<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>obj2<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token number\">10</span>\nchanged\nunchanged</code></pre></div>\n<p>è¿™è¯´æ˜Javascriptä¸­å‚æ•°ä¼ é€’æ˜¯ä»¥å€¼ä¼ é€’çš„æ–¹å¼è¿›è¡Œä¼ é€’çš„ï¼Œè€Œä¼ é€’çš„å†…å®¹æ˜¯<strong>å®ƒè‡ªå·±æœ¬èº«çš„å¼•ç”¨å€¼</strong></p>\n<p>ç”¨å®˜æ–¹æä¾›çš„å›¾è¡¨ç¤ºå¯èƒ½æ›´ä¸ºç›´è§‚ï¼ˆå·¦ä¸ºå¼•ç”¨ä¼ é€’ï¼Œå³ä¸ºå€¼ä¼ é€’ï¼‰</p>\n<p><img src=\"https://kiit-1253813979.cos.ap-guangzhou.myqcloud.com/vue-composition-api/pass-by-reference-vs-pass-by-value-animation.gif\" alt=\"pass-by-reference-vs-pass-by-value-animation\"></p>\n<p>æ‰€ä»¥ä¸Šé¢å“åº”ä¸¢å¤±çš„é—®é¢˜å°±å¯ä»¥è§£é‡Šäº†</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// è¿™é‡Œåªå–äº†useMousePositionè¿”å›å€¼çš„å¼•ç”¨å€¼</span>\n    <span class=\"token comment\">// è€Œå€¼é‡Œé¢çš„getter/setterä¸¢å¤±</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMousePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// å“åº”ä¸¢å¤±</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// å“åº”ä¸¢å¤±</span>\n    <span class=\"token comment\">// åŒä¸Š</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token function\">useMousePositon</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// It's work</span>\n    <span class=\"token comment\">// è¿™é‡Œçš„poså®é™…æ˜¯useMousePositoné‡Œé¢çš„posçš„å€¼</span>\n    <span class=\"token comment\">// æ‰€ä»¥pos.xä¸pos.yçš„å±æ€§ä¾æ—§å­˜åœ¨</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      pos<span class=\"token operator\">:</span> <span class=\"token function\">useMousePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>æ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜</h2>\n<h3>ä½¿ç”¨å®˜æ–¹æä¾›çš„API</h3>\n<p>çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå®˜æ–¹æœ‰æä¾›æœ‰ä¸¤ç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹<code class=\"language-text\">useMousePosition</code>ï¼Œé¦–å…ˆæ˜¯<code class=\"language-text\">toRefs</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useMousePostion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> pos <span class=\"token operator\">=</span> <span class=\"token function\">reactive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    y<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token function\">onMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Add Event Listener</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token function\">toRefs</span><span class=\"token punctuation\">(</span>pos<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// comsuming component</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Work!</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMousePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Work</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token function\">useMousePositon</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¦å¤–ä¸€ä¸ªæ˜¯ä½¿ç”¨<code class=\"language-text\">ref</code>å»åˆå§‹åŒ–state</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useMousePostion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token function\">onMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      x<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>x\n      y<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>y\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// Add Event Listener</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Work!</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMosuePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Work!</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span><span class=\"token function\">useMousePostion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>ä½¿ç”¨Typesciprt</h3>\n<p>ä½¿ç”¨Typescriptèƒ½ä¸¥æ ¼æ§åˆ¶å‡½æ•°å‚æ•°çš„ç±»åŠä»¥åŠç¡®å®šå‡½æ•°è¿”å›å€¼ï¼Œç»“åˆ <strong>Composition</strong> ä¼šå‘ç”Ÿæ€æ ·çš„åŒ–å­¦ååº”å‘¢ï¼Œæˆ‘ä»¬çœ‹ä»¥ä¸‹ä»£ç ï¼Œè¿˜æ˜¯åˆšæ‰çš„<code class=\"language-text\">useMousePosition</code>ä¾‹å­</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">useMosuePosition1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> pos <span class=\"token operator\">=</span> <span class=\"token function\">reactive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    y<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> pos\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useMousePostion2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token function\">ref</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Code IntelliSense</span>\n    <span class=\"token comment\">// x is number</span>\n    <span class=\"token comment\">// y is number</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMousePosition1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// x is Ref&lt;number></span>\n    <span class=\"token comment\">// y is Ref&lt;number></span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMousePosition2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è€Œä¸” <strong>Compotion API</strong> çš„å‡ºç°çš„å¦å¤–ä¸€ä¸ªåŸå› å°±æ˜¯ä¸ºäº†è§£å†³åœ¨2ä¸­ä¸€ç›´è¢«è¯Ÿç—…çš„typescriptæ”¯æŒé—®é¢˜ï¼Œä½¿ç”¨å‡½æ•°ä»£æ›¿é…ç½®çš„å½¢å¼èƒ½æ›´å¥½åœ°æ”¯æŒç±»å‹æ¨æ–­ï¼Œä¸ä¼šå‡ºç°åƒä»¥å‰æ‹“å±•äº†Vueçš„prototypeè€Œæ¨æ–­ä¸å‡ºé‡Œé¢çš„å®ä¾‹æ–¹æ³•ã€‚</p>\n<h2>Summary æ€»ç»“</h2>\n<p>æ–°çš„ <strong>Composition API</strong> è®©æˆ‘ä»¬æœ‰äº†æ›´å¥½çš„æ–¹å¼å»ç»„ç»‡æˆ‘ä»¬çš„ç»„ä»¶çŠ¶åŠæ–¹æ³•ï¼Œä½†æ˜¯ä¹Ÿåƒå®˜æ–¹ä»‹ç»æ–‡æ¡£è¯´çš„ä¸€æ · <strong>More Flexibility Requires More Discipline</strong>ï¼Œè·å¾—æ›´å¤šçµæ´»æ€§åŒæ—¶éœ€è¦æ›´å¤šçš„æ¡ä»¶å»çº¦æŸã€‚</p>\n<p>ä¸ç®¡æ˜¯<strong>React Hooks</strong>è¿˜æ˜¯<strong>Vue Componsition API</strong>ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥çŸ¥é“å‰ç«¯å·¥ç¨‹ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå‰ç«¯çš„æ¶æ„è®¾è®¡ä¹Ÿåœ¨ä¸æ–­çš„è¿›æ­¥ï¼Œç°ä»£æ¡†æ¶å¯¹å‰ç«¯JavascriptåŸºæœ¬çŸ¥è¯†æ˜¯è¶Šæ¥ä¸¥æ ¼ï¼Œå„ç§è½¯ä»¶è®¾è®¡æ¨¡å¼åœ¨å‰ç«¯å·¥ç¨‹ä¸­ä¹Ÿä¼šè¶Šæ¥è¶Šé‡è¦ã€‚</p>\n<p>å¸Œæœ›æ­¤æ–‡å¯¹å¤§å®¶åƒèƒèŸ¹æœ‰æ‰€å¯å‘ï¼Œå…±å‹‰ä¹‹ ğŸ™†â€â™€ï¸</p>\n<blockquote>\n<p><a href=\"https://vue-composition-api-rfc.netlify.com/#summary\">Vue Composition API RFC</a> â€”â€” Vue Composition APIä»‹ç»\n<a href=\"https://github.com/vuejs/composition-api\">Vue Compostion Repository</a> â€”â€” Vue Composition API Githubä»“åº“\n<a href=\"https://zh.wikipedia.org/wiki/%E6%B1%82%E5%80%BC%E7%AD%96%E7%95%A5\">æ±‚å€¼ç­–ç•¥</a> â€”â€” å¼•ç”¨ä¼ é€’ã€å€¼ä¼ é€’ä»‹ç»</p>\n</blockquote>","frontmatter":{"date":"October 21, 2019","path":"/post/vue-composition-api","title":"Vue composition API åƒèƒèŸ¹æŒ‡å—","category":["å‰ç«¯"]},"headings":[{"depth":2,"value":"Motivation"},{"depth":2,"value":"How"},{"depth":2,"value":"é€»è¾‘åˆ†ç¦»å’Œå¤ç”¨"},{"depth":2,"value":"ç¼ºç‚¹"},{"depth":3,"value":"å¼•ç”¨ä¼ é€’åŠå€¼ä¼ é€’"},{"depth":2,"value":"æ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜"},{"depth":3,"value":"ä½¿ç”¨å®˜æ–¹æä¾›çš„API"},{"depth":3,"value":"ä½¿ç”¨Typesciprt"},{"depth":2,"value":"Summary æ€»ç»“"}],"tableOfContents":"<ul>\n<li><a href=\"/post/vue-composition-api/#motivation\">Motivation</a></li>\n<li><a href=\"/post/vue-composition-api/#how\">How</a></li>\n<li><a href=\"/post/vue-composition-api/#%E9%80%BB%E8%BE%91%E5%88%86%E7%A6%BB%E5%92%8C%E5%A4%8D%E7%94%A8\">é€»è¾‘åˆ†ç¦»å’Œå¤ç”¨</a></li>\n<li>\n<p><a href=\"/post/vue-composition-api/#%E7%BC%BA%E7%82%B9\">ç¼ºç‚¹</a></p>\n<ul>\n<li><a href=\"/post/vue-composition-api/#%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92%E5%8F%8A%E5%80%BC%E4%BC%A0%E9%80%92\">å¼•ç”¨ä¼ é€’åŠå€¼ä¼ é€’</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/post/vue-composition-api/#%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3%E8%BF%99%E4%BA%9B%E9%97%AE%E9%A2%98\">æ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜</a></p>\n<ul>\n<li><a href=\"/post/vue-composition-api/#%E4%BD%BF%E7%94%A8%E5%AE%98%E6%96%B9%E6%8F%90%E4%BE%9B%E7%9A%84api\">ä½¿ç”¨å®˜æ–¹æä¾›çš„API</a></li>\n<li><a href=\"/post/vue-composition-api/#%E4%BD%BF%E7%94%A8typesciprt\">ä½¿ç”¨Typesciprt</a></li>\n</ul>\n</li>\n<li><a href=\"/post/vue-composition-api/#summary-%E6%80%BB%E7%BB%93\">Summary æ€»ç»“</a></li>\n</ul>"}},"pageContext":{"slug":"/post/vue-composition-api","next":{"frontmatter":{"title":"ä½¿ç”¨Webpackè®¾è®¡ä¸€ä¸ªæ‰€æœ‰é¡¹ç›®é€‚ç”¨çš„åˆ†åŒ…é…ç½®","date":"2019-09-06","category":["å‰ç«¯"],"tags":["webpack","æ€§èƒ½ä¼˜åŒ–"],"path":"/post/webpack-bundle-design"}},"previous":null}}}